{% extends "index.html" %}
{% load bank_tags media i18n helpers_tags pagination_tags %}
{% block title %}{% trans "Your links in bank!" %}{% endblock %}
{% block head-extra %}
{% include_media "my.js" %}
<script type="text/javascript">
window.addEvent("domready", function () {
    var searchPlaceholder = new Placeholder("id_q", "Поиск");
    var addLinkPlaceholder = new Placeholder("id_href", "{{ form.href.field.initial|escapejs }}");
    var editLinks = new BookmarkActiveLink(".edit_bookmark", { containerId: "main_container" });
    var delLinks = new BookmarkActiveLink(".del_bookmark", { containerId: "main_container" });
    {% url bank.views.link_search as search_url %}
    var navObj = new SiteNavigation("{{ search_url|escapejs }}", "id_q");
    /* reload on form success */
    editLinks.addEvent("formSuccess", function (win) {
        navObj.fireEvent("reload");
        setTimeout(function () {
            win.destroy()
        }.bind(this), 1500);
    }.bind(this));
    delLinks.addEvent("formSuccess", function (win) {
        navObj.fireEvent("reload");
        setTimeout(function () {
            win.destroy()
        }.bind(this), 1500);
    }.bind(this));
    setTimeout(function () {
        navObj.fireEvent("reload");
    }.bind(this), 100);
});
</script>
{% endblock %}

{% block header %}
  <div class="logout_div">
    <a title="{% trans "Sign out from site" %}" href="{% url logout %}">выйти</a>
  </div>
{% endblock %}

{% block content %}
<div class="content_inner">
  <div class="add_form_wrapper">
    <form action="{% url bank.views.link_create %}">
      {{ form.href }}
      <div class="form_submit_wrapper">
        <div class="form_submit_wrapper_inner" id="id_href_submit_wrapper">
          <input value="Add this!" type="submit">
        </div>
      </div>
    </form>
  </div>
  <div class="search_form_wrapper">
    <div class="form_submit_wrapper">
      <div class="form_submit_wrapper_inner" id="view_mode_wrapper">
      {% trans "View mode:" %} 
      <select>
        <option>{% trans "minimum" %}</option>
        <option>{% trans "normal" %}</option>
        <option>{% trans "maxmimum" %}</option>
      </select>
      </div>
    </div>

    <input id="id_q" type="text" name="q" value="Поиск" />

    <div class="form_submit_wrapper">
      <div class="form_submit_wrapper_inner" id="id_href_submit_wrapper">
        <input value="Search this!" type="button" id="search_this">
      </div>
    </div>
    <div class="sort_links">
        <a href="#" rel="added" class="sorting">{% trans "Added" %}</a>
        <br>
        <a href="#" rel="@weight" class="sorting">{% trans "Relevance" %}</a>
    </div>
  </div>

  <div id="main_container">
    {% include "bank/_list_ajax.html" %}
  </div>
</div>
{% endblock %}

{% block sidebar %}
  <div class="sidebar_username">
    <a href="#" title="{% trans "Profile, settings, password change & etc" %}">{{ user.username }}</a>
  </div>
  <h4 class="sidebar_tags_title">{% trans "Tags" %}</h4>
  {% tags_bar %}

  <h4 class="sidebar_bookmarklets_title">{% trans "Bookmarklets" %}</h4>
  <ul class="sidebar_bookmarklets">
      <li>
          <span>{% trans "Only href" %}</span>
          <a title="{% trans "Drag this to your browser toolbar" %}"
             href="javascript:var l=location.href;location.href='http://{{ current_site.domain }}{% url bank.views.link_create %}?href='+l">
              {% trans "To bank" %}
          </a>
      </li>
      <li>
          <span>{% trans "Href & title" %}</span>
          <a title="{% trans "Drag this to your browser toolbar" %}"
             href="javascript:var l=location.href;location.href='http://{{ current_site.domain }}{% url bank.views.link_create %}?href='+l+'&title='+document.title">
              {% trans "To bank" %}
          </a>
      </li>
      <li>
          <a title="{% trans "About bookmarklets" %}" href="/bookmarklets">
            {% trans "About bookmarklets" %}
          </a>
      </li>
  </ul>
{% endblock %}
