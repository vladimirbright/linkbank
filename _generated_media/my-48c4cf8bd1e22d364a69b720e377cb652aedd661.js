var Placeholder=new Class({edited:false,input:false,placeholder:false,Implements:[Options,Events],options:{onlyOnce:true},initialize:function(a,b,c){this.setOptions(c);this.input=$(a);this.placeholder=b;this.input.addEvent("change",function(){this.edited=true}.bind(this));this.input.addEvent("focus",this.setOnFocus.bind(this));this.input.addEvent("blur",this.setOnBlur.bind(this))},setOnFocus:function(){if(this.options.onlyOnce===true&&this.edited===true){this.removeEvents();return false}this.input.get("value")==
this.placeholder&&this.input.set("value","")},setOnBlur:function(){if(this.options.onlyOnce===true&&this.edited===true){this.removeEvents();return false}this.input.get("value")==""&&this.input.set("value",this.placeholder)},removeEvents:function(){this.input.removeEvent("focus",this.setOnFocus);this.input.removeEvent("blur",this.setOnBlur)}}),BookmarkActiveLink=new Class({Implements:[Options,Events],options:{onFormSuccess:function(){},onFormError:function(){},loadPlaceholder:new Element("div.ajax_bar_div"),
containerId:"main_container",stickyOpts:{allowMultiple:false,closeOnClickOut:false,closeOnEsc:true,destroyOnClose:true,showNow:true},loadRequestOpts:{method:"get",noCache:true},sendRequestOpts:{method:"post",noCache:true}},currentLink:false,currentStickyWin:false,currentForm:false,initialize:function(a,b){this.setOptions(b);$(this.options.containerId).addEvent("click:relay("+a+")",this.loadFormFromLink.bind(this))},loadFormFromLink:function(a,b){a.preventDefault();this.currentLink=$(b);this.createWin();
this.currentStickyWin.update();this.currentStickyWin.show()},createWin:function(){var a,b;a=this.currentLink.get("href");b=this.options.stickyOpts;b.url=a;b.requestOptions=this.options.loadRequestOpts;b.requestOptions.onComplete=function(){setTimeout(function(){this.currentStickyWin.position();this.bindForm()}.bind(this),30)}.bind(this);this.currentStickyWin=new StickyWin.Ajax(b)},bindForm:function(){var a;a=this.currentStickyWin.element.getElement("form");a=$(a);this.currentForm=new Form.Request(a,
{resetForm:false,requestOptions:this.options.sendRequestOpts});a.addEvent("submit",this.sendForm.bind(this));this.currentForm.request.addEvent("success",this.getFormResult.bind(this))},sendForm:function(a){a.preventDefault();this.currentForm.send()},getFormResult:function(a,b,c){this.currentStickyWin.setContent(c);this.currentStickyWin.position();c.toLowerCase().indexOf("<form")===-1?this.fireEvent("formSuccess"):this.fireEvent("formError")}});
